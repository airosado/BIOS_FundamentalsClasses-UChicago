---
title: "Discovering Oxygen Binding to Hb"
author: "Avery Rosado"
date: "2/25/2021"
output:
  html_document:
    theme: cosmo
    toc: yes
---
# Avery Rosado

```{r}
rm(list=ls())
```
$$   Y(pO_2) = \frac{pO_2}{pO_2+p50} $$
$$ p50 = \frac{1}{k_q} $$
## 1. Generate a random sample of birth months of 12 people and use the table() function to print out the frequencies of each month. Hint: you'll need to sample with replacement. How do the frequencies compare with the expected probabilities of each month? Calculate and report the mean and the variance of the sample and compare them to the *expected* mean and variance for the uniform distribution.

```{r}
#Q1
# 1a.
pO2 <- seq(0,100,1) #mmHg
p50 <- 2.4 #mmHg
# program this for the fraction of total myoglobin that is oxygenated 

fracMb <- pO2/(pO2+p50)
plot(pO2,fracMb,xlab="pO2 (mmHg)",ylab="Fraction of Total Mb oxygenated",main="Fraction of Mb Oxygenated vs pO2 levels",col=c(1),xlim=c(0,100),ylim=c(0,1),type="l")
# plot(0,0,type="n",xlab="labl",ylab="ylabl",main="title",col=c(1),xlim=c(0,1),ylim=c(0,3),type="l")
```
## 2. Choose 5 different p50 values -- plot all of the curves on one graph (be sure to include the "control" from above). Graph a horizontal line at the 1/2 way point in order to discuss the effects of changing P50. Include axes labels with units, title and a legend. Comment on your findings. What is the relationship between p50 and myoglobin saturation curves?
```{r}
#Q2
pO2 <- seq(0,100,1) #mmHg
#func
fracfunc <- function(){
    fracMbfunc <- pO2/(pO2+p50)
    return(fracMbfunc)
}
#callfunc3
p50 <- 2.4 
graphoutput1 <- fracfunc()
p50 <- 0.2
graphoutput2 <- fracfunc()
p50 <- 1.2
graphoutput3 <- fracfunc()
p50 <- 3.6 
graphoutput4 <- fracfunc()
p50 <- 4.8
graphoutput5 <- fracfunc()
p50 <- 9.6

graphoutput6 <- fracfunc()

plot(pO2,graphoutput1,xlab="pO2 (mmHg)",ylab="Fraction of Total Mb oxygenated ",main="Fraction of Mb Oxygenated vs pO2 levels",col=c(1),xlim=c(0,100),ylim=c(0,1),type="l")
lines(pO2,graphoutput2,col=c(2))
lines(pO2,graphoutput3,col=c(3))
lines(pO2,graphoutput4,col=c(4))
lines(pO2,graphoutput5,col=c(5))
lines(pO2,graphoutput6,col=c(6))
abline(h=0.5,col=c(1),lty="dashed")
legend("bottomright",legend=c("2.4 (control)","0.2","1.2","3.6","4.8","9.6","50%"),lty=1,col=c(1,2,3,4,5,6,1),title="pO2 (mmHg)")
```
```{r}
#Q3
expmntl_data=read.csv("/Users/airosado/Desktop/Hb Lab/Experimental_data.csv") # data frame
temp_data=read.csv("/Users/airosado/Desktop/Hb Lab/Temp_data_ExpF20.csv") # data frame
#expmntl
pO2 <- expmntl_data$data_pO2
Y <-expmntl_data$data_Y 
#temp
pO2_32 <- temp_data$data_pO2_32
Y_32 <- temp_data$data_Y_32
pO2_35<-temp_data$data_pO2_35
Y_35<-temp_data$data_Y_35
pO2_38<-temp_data$data_pO2_38
Y_38<-temp_data$data_Y_38
pO2_41<-temp_data$data_pO2_41
Y_41<-temp_data$data_Y_41
pO2_44<-temp_data$data_pO2_44
Y_44<-temp_data$data_Y_44
pO2_47<-temp_data$data_pO2_47
Y_47<-temp_data$data_Y_47
pO2_52<-temp_data$data_pO2_52
Y_52<-temp_data$data_Y_52

# 1
plot(expmntl_data$data_pO2,expmntl_data$data_Y,xlab="pO2 (mmHg)",ylab="Percentage of Total Mb oxygenated (%)",main="Fraction of Mb Oxygenated vs pO2 levels",xlim=c(0,100),ylim=c(0,100),col=c(1),type="l")
lines(temp_data$data_pO2_32,temp_data$data_Y_32,col=c(2))
lines(temp_data$data_pO2_35,temp_data$data_Y_35,col=c(3))
lines(temp_data$data_pO2_38,temp_data$data_Y_38,col=c(4))
lines(temp_data$data_pO2_41,temp_data$data_Y_41,col=c(5))
lines(temp_data$data_pO2_44,temp_data$data_Y_44,col=c(6))
lines(temp_data$data_pO2_47,temp_data$data_Y_47,col=c(7))
lines(temp_data$data_pO2_52,temp_data$data_Y_52,col=c(8))
abline(h=50,col=c(1),lty="dashed")
legend("bottomright",legend=c("2.4 (control)","0.2","1.2","3.6","4.8","9.6","50%"),lty=1,col=c(1,2,3,4,5,6,1),title="pO2 (mmHg)")

#pO2_32=temp_data$data_pO2_32
#Y_32=temp_data$data_Y_32
#pO2_35=temp_data$data_pO2_35
#Y_35=temp_data$data_Y_35
#pO2_38=temp_data$data_pO2_38
#Y_38=temp_data$data_Y_38
#pO2_41=temp_data$data_pO2_41
#Y_41=temp_data$data_Y_41
#pO2_44=temp_data$data_pO2_44
#Y_44=temp_data$data_Y_44
#pO2_47=temp_data$data_pO2_47
#Y_47=temp_data$data_Y_47
#pO2_52=temp_data$data_pO2_52
#Y_52=temp_data$data_Y_52

#########################
# 2
# Variable_column=Variablename $columnName
plot(pO2,Y,xlab="pO2 (mmHg)",ylab="Percentage of Total Mb oxygenated (%)",main="Fraction of Mb Oxygenated vs pO2 levels",xlim=c(0,100),ylim=c(0,100),col=c(1),type="l")
lines(pO2_32,Y_32,col=c(2))
lines(pO2_35,Y_35,col=c(3))
lines(pO2_38,Y_38,col=c(4))
lines(pO2_41,Y_41,col=c(5))
lines(pO2_44,Y_44,col=c(6))
lines(pO2_47,Y_47,col=c(7))
lines(pO2_52,Y_52,col=c(8))
abline(h=50,col=c(1),lty="dashed")
legend("bottomright",legend=c("2.4 (control)","0.2","1.2","3.6","4.8","9.6","50%"),lty=1,col=c(1,2,3,4,5,6,1),title="pO2 (mmHg)")

###################
# 3
#expmntl
pO2 <- expmntl_data[,1]
Y <- expmntl_data[,2]
#temp
pO2_32 <- temp_data[,1]
Y_32 <- temp_data[,2] 
pO2_35<- temp_data[,3]
Y_35<- temp_data[,4]
pO2_38<- temp_data[,5]
Y_38<- temp_data[,6]
pO2_41<- temp_data[,7]
Y_41<- temp_data[,8]
pO2_44<- temp_data[,9]
Y_44<- temp_data[,10]
pO2_47<- temp_data[,11]
Y_47<- temp_data[,12]
pO2_52<- temp_data[,13]
Y_52<- temp_data[,14]

plot(expmntl_data[,1],expmntl_data[,2] ,xlab="pO2 (mmHg)",ylab="Percentage of Total Mb oxygenated (%)",main="Fraction of Mb Oxygenated vs pO2 levels",xlim=c(0,100),ylim=c(0,100),col=c(1),type="l")
lines(temp_data[,1] ,temp_data[,2] ,col=c(2))
lines(temp_data[,3] ,temp_data[,4] ,col=c(3))
lines(temp_data[,5] ,temp_data[,6] ,col=c(4))
lines(temp_data[,7] ,temp_data[,8] ,col=c(5))
lines(temp_data[,9] ,temp_data[,10] ,col=c(6))
lines(temp_data[,11] ,temp_data[,12] ,col=c(7))
lines(temp_data[,13] ,temp_data[,14] ,col=c(8))
abline(h=50,col=c(1),lty="dashed")
legend("bottomright",legend=c("2.4 (control)","0.2","1.2","3.6","4.8","9.6","50%"),lty=1,col=c(1,2,3,4,5,6,1),title="pO2 (mmHg)")

#########################
# 4
#Exp.data <-data.frame(x=experimental[,1],y=experimental[,2])
#Temp_32<data.frame(x=temp[,1)]y=temp[,2]
pO2m <- data.frame(x=expmntl_data[,1],y=expmntl_data[,2])
pO2_32m <-data.frame(x=temp_data[,1],y=temp_data[,2])
pO2_35m <-data.frame(x=temp_data[,3],y=temp_data[,4])
pO2_38m <-data.frame(x=temp_data[,5],y=temp_data[,6])
pO2_41m <-data.frame(x=temp_data[,7],y=temp_data[,8])
pO2_44m <-data.frame(x=temp_data[,9],y=temp_data[,10])
pO2_47m <-data.frame(x=temp_data[,11],y=temp_data[,12])
pO2_52m <-data.frame(x=temp_data[,13],y=temp_data[,14])

plot(pO2m[,1],pO2m[,2],xlab="pO2 (mmHg)",ylab="Percentage of Total Mb oxygenated (%)",main="Fraction of Mb Oxygenated vs pO2 levels",xlim=c(0,100),ylim=c(0,100),col=c(1),type="l")
lines(pO2_32m[,1],pO2_32m[,2],col=c(2))
lines(pO2_35m[,1],pO2_35m[,2],col=c(3))
lines(pO2_38m[,1],pO2_38m[,2],col=c(4))
lines(pO2_41m[,1],pO2_41m[,2],col=c(5))
lines(pO2_44m[,1],pO2_44m[,2],col=c(6))
lines(pO2_47m[,1],pO2_47m[,2],col=c(7))
lines(pO2_52m[,1],pO2_52m[,2],col=c(8))
abline(h=50,col=c(1),lty="dashed")

expmntl_data=read.csv("/Users/airosado/Desktop/Hb Lab/Experimental_data.csv") # data frame
temp_data=read.csv("/Users/airosado/Desktop/Hb Lab/Temp_data_ExpF20.csv") # data frame
#Exp.data <-data.frame(x=experimental[,1],y=experimental[,2])
#Temp_32<data.frame(x=temp[,1)]y=temp[,2]
pO2 <- data.frame(x=expmntl_data[,1],y=expmntl_data[,2])
pO2_32 <-data.frame(x=temp_data[,1],y=temp_data[,2])
pO2_35 <-data.frame(x=temp_data[,3],y=temp_data[,4])
pO2_38 <-data.frame(x=temp_data[,5],y=temp_data[,6])
pO2_41 <-data.frame(x=temp_data[,7],y=temp_data[,8])
pO2_44 <-data.frame(x=temp_data[,9],y=temp_data[,10])
pO2_47 <-data.frame(x=temp_data[,11],y=temp_data[,12])
pO2_52 <-data.frame(x=temp_data[,13],y=temp_data[,14])

plot(pO2[,1],pO2[,2],xlab="pO2 (mmHg)",ylab="Percentage of Total Mb oxygenated (%)",main="Fraction of Mb Oxygenated vs pO2 levels",xlim=c(0,100),ylim=c(0,100),col=c(1),type="l")
lines(pO2_32[,1],pO2_32[,2],col=c(2))
lines(pO2_35[,1],pO2_35[,2],col=c(3))
lines(pO2_38[,1],pO2_38[,2],col=c(4))
lines(pO2_41[,1],pO2_41[,2],col=c(5))
lines(pO2_44[,1],pO2_44[,2],col=c(6))
lines(pO2_47[,1],pO2_47[,2],col=c(7))
lines(pO2_52[,1],pO2_52[,1],col=c(8))
abline(h=50,col=c(1),lty="dashed")
legend("bottomright",legend=c("2.4 (control)","0.2","1.2","3.6","4.8","9.6","50%"),lty=1,col=c(1,2,3,4,5,6,1),title="pO2 (mmHg)")
#######################################
#5
#expmntl
pO2 <- expmntl_data[,1]
Y <- expmntl_data[,2]
#temp
pO2_32 <- temp_data[,1]
Y_32 <- temp_data[,2] 
pO2_35<- temp_data[,3]
Y_35<- temp_data[,4]
pO2_38<- temp_data[,5]
Y_38<- temp_data[,6]
pO2_41<- temp_data[,7]
Y_41<- temp_data[,8]
pO2_44<- temp_data[,9]
Y_44<- temp_data[,10]
pO2_47<- temp_data[,11]
Y_47<- temp_data[,12]
pO2_52<- temp_data[,13]
Y_52<- temp_data[,14]

plot(pO2,Y,xlab="pO2 (mmHg)",ylab="Percentage of Total Mb oxygenated (%)",main="Fraction of Mb Oxygenated vs pO2 levels",xlim=c(0,100),ylim=c(0,100),col=c(1),type="l")
lines(pO2_32,Y_32,col=c(2))
lines(pO2_35,Y_35,col=c(3))
lines(pO2_38,Y_38,col=c(4))
lines(pO2_41,Y_41,col=c(5))
lines(pO2_44,Y_44,col=c(6))
lines(pO2_47,Y_47,col=c(7))
lines(pO2_52,Y_52,col=c(8))
abline(h=50,col=c(1),lty="dashed")
legend("bottomright",legend=c("2.4 (control)","0.2","1.2","3.6","4.8","9.6","50%"),lty=1,col=c(1,2,3,4,5,6,1),title="pO2 (mmHg)")
##############################
# 6
matrix <-data.frame(pO2,Y)
matrix32 <-data.frame(pO2_32,Y_32)
matrix35 <-data.frame(pO2_35,Y_35)
matrix38 <-data.frame(pO2_38,Y_38)
matrix41 <-data.frame(pO2_41,Y_41)
matrix44 <-data.frame(pO2_44,Y_44)
matrix47 <-data.frame(pO2_47,Y_47)
matrix52<-data.frame(pO2_52,Y_52)

plot(matrix[,1],matrix[,2],xlab="pO2 (mmHg)",ylab="Percentage of Total Mb oxygenated (%)",main="Fraction of Mb Oxygenated vs pO2 levels",xlim=c(0,100),ylim=c(0,100),col=c(1),type="l")
lines(matrix32[,1],matrix32[,2],xlab="pO2 (mmHg)",ylab="Percentage of Total Mb oxygenated (%)",main="Fraction of Mb Oxygenated vs pO2 levels",xlim=c(0,100),ylim=c(0,100),col=c(2),type="l")
lines(matrix35[,1],matrix35[,2],xlab="pO2 (mmHg)",ylab="Percentage of Total Mb oxygenated (%)",main="Fraction of Mb Oxygenated vs pO2 levels",xlim=c(0,100),ylim=c(0,100),col=c(3),type="l")
lines(matrix38[,1],matrix38[,2],xlab="pO2 (mmHg)",ylab="Percentage of Total Mb oxygenated (%)",main="Fraction of Mb Oxygenated vs pO2 levels",xlim=c(0,100),ylim=c(0,100),col=c(4),type="l")
lines(matrix41[,1],matrix41[,2],xlab="pO2 (mmHg)",ylab="Percentage of Total Mb oxygenated (%)",main="Fraction of Mb Oxygenated vs pO2 levels",xlim=c(0,100),ylim=c(0,100),col=c(5),type="l")
lines(matrix44[,1],matrix44[,2],xlab="pO2 (mmHg)",ylab="Percentage of Total Mb oxygenated (%)",main="Fraction of Mb Oxygenated vs pO2 levels",xlim=c(0,100),ylim=c(0,100),col=c(6),type="l")
lines(matrix47[,1],matrix47[,2],xlab="pO2 (mmHg)",ylab="Percentage of Total Mb oxygenated (%)",main="Fraction of Mb Oxygenated vs pO2 levels",xlim=c(0,100),ylim=c(0,100),col=c(7),type="l")
lines(matrix52[,1],matrix52[,2],xlab="pO2 (mmHg)",ylab="Percentage of Total Mb oxygenated (%)",main="Fraction of Mb Oxygenated vs pO2 levels",xlim=c(0,100),ylim=c(0,100),col=c(8),type="l")
abline(h=50,col=c(1),lty="dashed")
legend("bottomright",legend=c("2.4 (control)","0.2","1.2","3.6","4.8","9.6","50%"),lty=1,col=c(1,2,3,4,5,6,1),title="pO2 (mmHg)")
```

# END OF PRELAB

